# Jenkins Configuration as Code - Docker Cloud
# This file configures Docker Cloud for Jenkins agents
# Managed by Ansible - Do not edit manually

clouds:
  - docker:
      name: "docker-cloud"
      dockerApi:
        dockerHost:
          uri: "{{ jenkins_docker_cloud_docker_host }}"
      containerCap: 10
      connectTimeout: 5
      readTimeout: 60
      templates:
        - description: "Docker Cloud build agent"
          label: "docker-agent"
          dockerImage: "{{ jenkins_docker_cloud_container_template.image | default('docker:dind') }}"
          remoteFs: "/home/jenkins"
          connector:
            attach:
              user: "root"
          removeVolumes: true
          stopTimeout: 10
          pullStrategy: PULL_ALWAYS
          privileged: true
          environment:
            - "DOCKER_HOST={{ jenkins_docker_cloud_docker_host }}"
            - "DOCKER_TLS_VERIFY="
            - "DOCKER_CERT_PATH="
          volumes:
            - "/var/run/docker.sock:/var/run/docker.sock"
            - "/home/jenkins:/home/jenkins"
          memoryLimit: {{ jenkins_docker_cloud_container_template.memory_limit | default(2147483648) }}
          cpuLimit: {{ jenkins_docker_cloud_container_template.cpu_limit | default(2) }}
          retentionStrategy:
            idleMinutes: 10
          numExecutors: 1
          nodeUsageMode: NORMAL
