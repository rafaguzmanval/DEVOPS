---
# Docker Compose configuration for Jenkins with Docker Cloud
# Managed by Ansible - Do not edit manually

services:
  # Docker Cloud service for running Docker daemons



  # Jenkins CI/CD service (custom image with pre-installed plugins and config)
  jenkins:
    build:
      context: .
      dockerfile: Dockerfile
    image: {{ jenkins_custom_image | default('jenkins-custom:lts') }}
    container_name: {{ jenkins_container_name | default('jenkins') }}
    restart: always
    network_mode: host
    privileged: true
    volumes:
      - jenkins_data:/var/jenkins_home
      - /home/jenkins:/home/jenkins
      - /var/run/docker.sock:/var/run/docker.sock
    environment:
      - JAVA_OPTS=-Djenkins.install.runSetupWizard=false -Dcasc.jenkins.config=/var/jenkins_home/casc_configs
      - CASC_JENKINS_CONFIG=/var/jenkins_home/casc_configs
      - DOCKER_HOST={{ jenkins_docker_cloud_docker_host | default('tcp://127.0.0.1:2375') }}
      - DOCKER_TLS_VERIFY=
      - DOCKER_CERT_PATH=
      - DOCKER_TLS_CERTDIR=
    labels:
      app: jenkins

volumes:
  jenkins_data:
    driver: local
  docker_cloud_data:
    driver: local
